---
layout: default
title: 关于并发
---
<h1>{{ page.title }}</h1>
<p>{{ page.date | date_to_string }}</p>

----

## 线程安全性

核心是对状态访问操作进行管理，特别是**共享**和**可变**的状态

### 安全性的定义

当多个线程访问某个类时，这个类始终能表现出正确的行为，我们就说这个类是线程安全的

### 原子性

#### 竞态条件

程序执行的正确性取决于程序的执行时序

* 先检查，后执行
* 读取-修改-写入

#### 复合操作

一组必须以原子方式执行的操作，以保证线程的安全性

要保证对象状态的一致性，就要在单个原子操作中更新所有相关的状态变量

### Java中的同步机制

* synchronized
* volatile
* 显示加锁
* 原子变量

不恰当的加锁会带来`活跃性`或者`性能`问题

* 加锁范围过大，导致性能降低
* 加锁顺序不恰当，产生死锁

## 活跃性，性能与测试

### 活跃性问题

线程由于某种原因不能继续执行

#### 死锁

* 锁顺序死锁
* 动态的锁顺序死锁
* 资源死锁
* 协作间对象的死锁
  * （开放调用）

#### 饥饿

#### 活锁

#### 糟糕的响应性


